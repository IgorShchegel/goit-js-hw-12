{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.search-form');\nconst searchInput = document.querySelector('.search-input');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.button-more');\nconst loader = document.querySelector('.loader');\nconst hiddenClass = 'is-hidden';\n\nlet searchQuery = '';\nlet page = 1;\nlet maxPage = 0;\nconst pageSize = 40;\n\nhideLoader();\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  searchQuery = searchInput.value;\n  gallery.innerHTML = '';\n  page = 1;\n  showLoader();\n\n  try {\n    const { hits, totalHits } = await fetchImages(searchQuery);\n    maxPage = Math.ceil(totalHits / pageSize);\n    displayImages(hits);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      showButton();\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      hideButton();\n    }\n  } catch (error) {\n    showMessage(error);\n  } finally {\n    hideLoader();\n  }\n});\n\nasync function fetchImages(query) {\n  const key = '41984486-af85e40ac9c664bf86aaf37aa';\n\n  const url = `https://pixabay.com/api/?`;\n\n  try {\n    const response = await axios.get(url, {\n      params: {\n        key: key,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        page: page,\n        per_page: 40,\n        safesearch: true,\n      },\n    });\n    if (response.data.hits.length === 0) {\n      searchForm.reset();\n      hideButton();\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else {\n      return response.data;\n    }\n  } catch (error) {\n    throw new Error(error);\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction displayImages(images) {\n  gallery.insertAdjacentHTML('beforeend', createMarkup(images));\n  lightbox.refresh();\n  searchForm.reset();\n  getCardHeight();\n}\n\nfunction createMarkup(image) {\n  return image\n    .map(\n      image =>\n        `<li class=\"card\">\n         <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n           <img\n               class=\"gallery-image\"\n               src=\"${image.webformatURL}\"\n               alt=\"${image.tags}\"\n            />\n            <ul class=\"info\">\n            <li class=\"info-items\">Likes: ${image.likes}</li>\n            <li class=\"info-items\">Views: ${image.views}</li>\n            <li class=\"info-items\">Comments: ${image.comments}</li>\n            <li class=\"info-items\">Downloads: ${image.downloads}</li>\n            </ul>\n         </a> \n        </li>   \n  `\n    )\n    .join('');\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  disableButton();\n  showLoader();\n  try {\n    const { hits } = await fetchImages(searchQuery);\n\n    displayImages(hits);\n  } catch (error) {\n    showMessage(error);\n  } finally {\n    enableButton();\n    hideLoader();\n    smoothScrollToNextGroup();\n    if (page === maxPage) {\n      iziToast.info({\n        title: '',\n        message:\n          'We are sorry, but you have reached the end of search results.',\n        position: 'topRight',\n      });\n\n      hideButton();\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\nfunction showMessage(message) {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction hideButton() {\n  loadMoreBtn.classList.add(hiddenClass);\n}\n\nfunction showButton() {\n  loadMoreBtn.classList.remove(hiddenClass);\n}\n\nfunction enableButton() {\n  loadMoreBtn.disabled = false;\n}\n\nfunction disableButton() {\n  loadMoreBtn.disabled = true;\n}\n\nfunction getCardHeight() {\n  const imageCard = document.querySelector('.card');\n  return imageCard.getBoundingClientRect().height;\n}\n\nfunction smoothScrollToNextGroup() {\n  const cardHeight = getCardHeight();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["searchForm","searchInput","gallery","loadMoreBtn","loader","hiddenClass","searchQuery","page","maxPage","pageSize","hideLoader","event","showLoader","hits","totalHits","fetchImages","displayImages","showButton","handleLoadMore","hideButton","showMessage","query","key","url","response","axios","error","lightbox","SimpleLightbox","images","createMarkup","getCardHeight","image","disableButton","enableButton","smoothScrollToNextGroup","iziToast","message","cardHeight"],"mappings":"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"}